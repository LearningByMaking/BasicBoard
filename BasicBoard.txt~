;ulogo file for BasicBoard
 
constants [[rpacket $1fc0]] ;this constant defined the memory address where packets are written on the MSP430

 
 to ul-power
	 init-leds 
	 redon 
	 wait 10 
	 redoff 
 end
 
 to ul-init
	 yellowon 
	 wait 10
         prepareIOPinsforExternalLeds
	 yellowoff
 end 

 to yellowon
	 redon
	 greenon
 end

 to yellowoff
	 redoff
	 greenoff
 end 

 to prepareIOPinsforExternalLeds
	dp3output 
	dp3off 
        dp2output 
        dp2off 
 end 
 
 to ul-go
 	 greenon
	 wait 10
	 greenoff

	 loop 
	 [
		greenon	 	
		collect-data
		wait 10 
		greenoff
	 	wait 100
	 ]
 
 end

 to collect-data
 	init-packet 42 
 	fprint readLightSensor
 	fprint readTempSensor1
 	fprint readTempSensor2
 	add-checksum 
 end

to readLightSensor
   output readADC 6 
end

to readTempSensor1
   output readADC 5
end

to readTempSensor2
   output readADC 4
end

;code NOT used in the regular ul-run loop

to calibrateADC :n 
   let [total 0] 
   let [sample 10] 
   repeat :sample	
   [
     let [adc (readADC :n)] 
     let [total :total + :adc] 
     print :adc      
     wait 10
   ]
   let [total :total / :sample] 
   prs "Average:
   print :total 

end

to led1on
   dp3on 
end

to led1off
  dp3off 
end

to led2on
   dp2on 
end

to led2off 
   dp2off 
end


